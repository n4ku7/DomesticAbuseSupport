{% extends 'base.html' %}

{% block content %}
<section class="card">
    <h2 class="title">Professional Team Directory</h2>
    <p class="subtitle">Manage available counsellors and legal advisors for case assignment.</p>

    <form method="get" class="filter-bar">
        <input type="text" name="q" value="{{ current_query }}" placeholder="Search username, email, phone">
        <select name="role">
            <option value="">All Roles</option>
            <option value="counsellor" {% if current_role == 'counsellor' %}selected{% endif %}>Counsellor</option>
            <option value="legal_advisor" {% if current_role == 'legal_advisor' %}selected{% endif %}>Legal Advisor</option>
        </select>
        <select name="status">
            <option value="">All Status</option>
            <option value="active" {% if current_status == 'active' %}selected{% endif %}>Active</option>
            <option value="inactive" {% if current_status == 'inactive' %}selected{% endif %}>Inactive</option>
        </select>
        <button type="submit">Apply</button>
        <a href="{% url 'professional_list' %}" class="btn btn-secondary">Reset</a>
    </form>

    <div class="actions">
        <a href="{% url 'create_professional' %}" class="btn">Create Professional</a>
        <a href="{% url 'dashboard' %}" class="btn btn-secondary">Back to Dashboard</a>
    </div>

    <ul class="list">
        {% for member in professionals %}
            <li class="list-item">
                <div class="list-head">
                    <strong>{{ member.username }}</strong>
                    <span class="badge badge-default">{{ member.get_role_display }}</span>
                </div>
                <div class="spacer-sm"></div>
                <p class="muted"><strong>Email:</strong> {{ member.email|default:'Not provided' }}</p>
                <p class="muted"><strong>Phone:</strong> {{ member.phone_number|default:'Not provided' }}</p>
                <p class="muted"><strong>Status:</strong> {% if member.is_active %}Active{% else %}Inactive{% endif %}</p>
                <div class="inline-actions">
                    <a href="{% url 'edit_professional' member.pk %}" class="btn btn-secondary">Edit</a>
                    <a href="{% url 'delete_professional' member.pk %}" class="btn btn-danger">Delete</a>
                </div>
            </li>
        {% empty %}
            <li class="list-item empty-state">No professionals created yet.</li>
        {% endfor %}
    </ul>

    {% if is_paginated %}
        <div class="pagination">
            {% if page_obj.has_previous %}
                <a href="{% if query_params %}?{{ query_params }}&page={{ page_obj.previous_page_number }}{% else %}?page={{ page_obj.previous_page_number }}{% endif %}" class="btn btn-secondary">Previous</a>
            {% endif %}

            <span class="page-indicator">Page {{ page_obj.number }} of {{ paginator.num_pages }}</span>

            {% if page_obj.has_next %}
                <a href="{% if query_params %}?{{ query_params }}&page={{ page_obj.next_page_number }}{% else %}?page={{ page_obj.next_page_number }}{% endif %}" class="btn btn-secondary">Next</a>
            {% endif %}
        </div>
    {% endif %}
</section>
{% endblock %}
